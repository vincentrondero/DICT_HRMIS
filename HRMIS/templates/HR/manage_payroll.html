{% extends "base.html" %}
{% block content %}
<form method="post" enctype="multipart/form-data" action="{% url 'upload_and_cleanse' %}">
    {% csrf_token %}
    <div class="max-w-md bg-white shadow-custom rounded-xl m-2">
        <label for="file-upload" class="max-w-md bg-white shadow-custom rounded-md m-2 cursor-pointer">
            <div class="flex items-center justify-center">
                <svg width="150" height="150" viewBox="0 0 150 150" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M77.75 92.1875H23.4375C20.875 92.1875 18.75 90.0625 18.75 87.5C18.75 84.9375 20.875 82.8125 23.4375 82.8125H77.75L67 72.0625C65.1875 70.25 65.1875 67.25 67 65.4375C68.8125 63.625 71.8125 63.625 73.625 65.4375L92.375 84.1875C92.8125 84.625 93.125 85.125 93.375 85.6875C93.875 86.8125 93.875 88.125 93.375 89.25C93.125 89.8125 92.8125 90.3125 92.375 90.75L73.625 109.5C72.6875 110.438 71.5 110.875 70.3125 110.875C69.125 110.875 67.9375 110.438 67 109.5C66.1283 108.618 65.6394 107.428 65.6394 106.188C65.6394 104.947 66.1283 103.757 67 102.875L77.75 92.125V92.1875ZM131.25 59.375V112.5C131.25 122 123.562 129.688 114.062 129.688H67.1875C57.6875 129.688 50 122 50 112.5V106.25C50 103.688 52.125 101.562 54.6875 101.562C57.25 101.562 59.375 103.688 59.375 106.25V112.5C59.375 116.812 62.875 120.312 67.1875 120.312H114.062C118.375 120.312 121.875 116.812 121.875 112.5V64.0625H92.1875C89.625 64.0625 87.5 61.9375 87.5 59.375V29.6875H67.1875C62.875 29.6875 59.375 33.1875 59.375 37.5V68.75C59.375 71.3125 57.25 73.4375 54.6875 73.4375C52.125 73.4375 50 71.3125 50 68.75V37.5C50 28 57.6875 20.3125 67.1875 20.3125H92.1875C93.4375 20.3125 94.625 20.8125 95.5 21.6875L129.875 56.0625C130.75 56.9375 131.25 58.125 131.25 59.375ZM96.875 54.6875H115.25L96.875 36.3125V54.6875Z" fill="#0F5FC2" fill-opacity="0.760784"/>
                </svg> 
                <input id="file-upload" type="file" name="file" class="hidden">
            </div>
            <h2 class="text-xl font-semibold text-gray-800 flex justify-center pb-3">Import Data</h2>
        </label>
        <button type="submit">Upload and Cleanse</button>
    </div>
</form>

<div class="py-3">
    <table class="shadow-custom" style="margin-left: 1%; width: 98%;">
        <thead class="bg-custom-blue text-white" >
            <tr>
                <th>No:</th>
                <th>Name</th>
                <th>Role</th>
                <th>Attendance</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody class="bg-white">
            <tr>
                <td  class="text-center align-middle" style="padding-top: 20px; padding-bottom: 20px">sample</td>
                <td  class="text-center align-middle" style="padding-top: 20px; padding-bottom: 20px">sample</td>
                <td  class="text-center align-middle "style="padding-top: 20px; padding-bottom: 20px">sample</td>
                <td class="flex items-center justify-center" style="padding-top: 20px; padding-bottom: 20px">
                    <button class="flex items-center bg-custom-blue text-white text-xs p-2 rounded-md">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="text-lg mr-1" viewBox="0 0 24 24">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M20 4H4C3.73478 4 3.48043 4.10536 3.29289 4.29289C3.10536 4.48043 3 4.73478 3 5V19C3 19.2652 3.10536 19.5196 3.29289 19.7071C3.48043 19.8946 3.73478 20 4 20H20C20.2652 20 20.5196 19.8946 20.7071 19.7071C20.8946 19.5196 21 19.2652 21 19V5C21 4.73478 20.8946 4.48043 20.7071 4.29289C20.5196 4.10536 20.2652 4 20 4ZM4 2C3.20435 2 2.44129 2.31607 1.87868 2.87868C1.31607 3.44129 1 4.20435 1 5V19C1 19.7956 1.31607 20.5587 1.87868 21.1213C2.44129 21.6839 3.20435 22 4 22H20C20.7956 22 21.5587 21.6839 22.1213 21.1213C22.6839 20.5587 23 19.7956 23 19V5C23 4.20435 22.6839 3.44129 22.1213 2.87868C21.5587 2.31607 20.7956 2 20 2H4ZM6 7H8V9H6V7ZM11 7C10.7348 7 10.4804 7.10536 10.2929 7.29289C10.1054 7.48043 10 7.73478 10 8C10 8.26522 10.1054 8.51957 10.2929 8.70711C10.4804 8.89464 10.7348 9 11 9H17C17.2652 9 17.5196 8.89464 17.7071 8.70711C17.8946 8.51957 18 8.26522 18 8C18 7.73478 17.8946 7.48043 17.7071 7.29289C17.5196 7.10536 17.2652 7 17 7H11ZM8 11H6V13H8V11ZM10 12C10 11.7348 10.1054 11.4804 10.2929 11.2929C10.4804 11.1054 10.7348 11 11 11H17C17.2652 11 17.5196 11.1054 17.7071 11.2929C17.8946 11.4804 18 11.7348 18 12C18 12.2652 17.8946 12.5196 17.7071 12.7071C17.5196 12.8946 17.2652 13 17 13H11C10.7348 13 10.4804 12.8946 10.2929 12.7071C10.1054 12.5196 10 12.2652 10 12ZM8 15H6V17H8V15ZM10 16C10 15.7348 10.1054 15.4804 10.2929 15.2929C10.4804 15.1054 10.7348 15 11 15H17C17.2652 15 17.5196 15.1054 17.7071 15.2929C17.8946 15.4804 18 15.7348 18 16C18 16.2652 17.8946 16.5196 17.7071 16.7071C17.5196 16.8946 17.2652 17 17 17H11C10.7348 17 10.4804 16.8946 10.2929 16.7071C10.1054 16.5196 10 16.2652 10 16Z"/>
                        </svg>
                        Attendance
                    </button>                    
                </td>
                <td class="text-center align-middle" style="padding-top: 20px; padding-bottom: 20px">
                    <button class="bg-custom-button1 p-2 rounded-md relative group">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="text-lg text-custom-color-blue" viewBox="0 0 24 24">
                            <path d="M23.205 11.745C22.3229 9.46324 20.7915 7.48996 18.8001 6.06906C16.8088 4.64817 14.4447 3.84193 12 3.75C9.55544 3.84193 7.19134 4.64817 5.19995 6.06906C3.20856 7.48996 1.67717 9.46324 0.795047 11.745C0.735473 11.9098 0.735473 12.0902 0.795047 12.255C1.67717 14.5368 3.20856 16.51 5.19995 17.9309C7.19134 19.3518 9.55544 20.1581 12 20.25C14.4447 20.1581 16.8088 19.3518 18.8001 17.9309C20.7915 16.51 22.3229 14.5368 23.205 12.255C23.2646 12.0902 23.2646 11.9098 23.205 11.745ZM12 18.75C8.02505 18.75 3.82505 15.8025 2.30255 12C3.82505 8.1975 8.02505 5.25 12 5.25C15.975 5.25 20.175 8.1975 21.6975 12C20.175 15.8025 15.975 18.75 12 18.75Z" fill="#0F5FC2" fill-opacity="0.760784"/>
                            <path d="M12 7.5C11.11 7.5 10.24 7.76392 9.49994 8.25839C8.75991 8.75285 8.18314 9.45566 7.84254 10.2779C7.50195 11.1002 7.41283 12.005 7.58647 12.8779C7.7601 13.7508 8.18869 14.5526 8.81802 15.182C9.44736 15.8113 10.2492 16.2399 11.1221 16.4135C11.995 16.5872 12.8998 16.4981 13.7221 16.1575C14.5443 15.8169 15.2471 15.2401 15.7416 14.5001C16.2361 13.76 16.5 12.89 16.5 12C16.5 10.8065 16.0259 9.66193 15.182 8.81802C14.3381 7.97411 13.1935 7.5 12 7.5ZM12 15C11.4067 15 10.8266 14.8241 10.3333 14.4944C9.83994 14.1648 9.45543 13.6962 9.22836 13.148C9.0013 12.5999 8.94189 11.9967 9.05765 11.4147C9.1734 10.8328 9.45912 10.2982 9.87868 9.87868C10.2982 9.45912 10.8328 9.1734 11.4147 9.05764C11.9967 8.94189 12.5999 9.0013 13.1481 9.22836C13.6962 9.45542 14.1648 9.83994 14.4944 10.3333C14.8241 10.8266 15 11.4067 15 12C15 12.7956 14.6839 13.5587 14.1213 14.1213C13.5587 14.6839 12.7957 15 12 15Z"/>
                        </svg>
                        <div class="opacity-0 w-28 bg-white text-black text-center text-xs rounded-lg py-2 absolute z-10 border-2 border-black group-hover:opacity-100 bottom-full -left-10 px-3 pointer-events-none shadow-md">
                            View Payroll
                            <svg class="absolute text-black h-2 w-full left-0 top-full" x="0px" y="0px" viewBox="0 0 255 255" xml:space="preserve"><polygon class="fill-current" points="0,0 127.5,127.5 255,0"/></svg>
                        </div>
                    </button> 
                    <button class="bg-custom-button1 p-2 rounded-md">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="text-lg text-custom-color-blue" viewBox="0 0 24 24">
                            <path d="M18 16.75H16C15.8011 16.75 15.6103 16.671 15.4697 16.5303C15.329 16.3897 15.25 16.1989 15.25 16C15.25 15.8011 15.329 15.6103 15.4697 15.4697C15.6103 15.329 15.8011 15.25 16 15.25H18C18.3315 15.25 18.6495 15.1183 18.8839 14.8839C19.1183 14.6495 19.25 14.3315 19.25 14V10C19.25 9.66848 19.1183 9.35054 18.8839 9.11612C18.6495 8.8817 18.3315 8.75 18 8.75H6C5.66848 8.75 5.35054 8.8817 5.11612 9.11612C4.8817 9.35054 4.75 9.66848 4.75 10V14C4.75 14.3315 4.8817 14.6495 5.11612 14.8839C5.35054 15.1183 5.66848 15.25 6 15.25H8C8.19891 15.25 8.38968 15.329 8.53033 15.4697C8.67098 15.6103 8.75 15.8011 8.75 16C8.75 16.1989 8.67098 16.3897 8.53033 16.5303C8.38968 16.671 8.19891 16.75 8 16.75H6C5.27065 16.75 4.57118 16.4603 4.05546 15.9445C3.53973 15.4288 3.25 14.7293 3.25 14V10C3.25 9.27065 3.53973 8.57118 4.05546 8.05546C4.57118 7.53973 5.27065 7.25 6 7.25H18C18.7293 7.25 19.4288 7.53973 19.9445 8.05546C20.4603 8.57118 20.75 9.27065 20.75 10V14C20.75 14.7293 20.4603 15.4288 19.9445 15.9445C19.4288 16.4603 18.7293 16.75 18 16.75Z" />
                            <path d="M16 8.75C15.8019 8.74741 15.6126 8.66756 15.4725 8.52747C15.3324 8.38737 15.2526 8.19811 15.25 8V4.75H8.75V8C8.75 8.19891 8.67098 8.38968 8.53033 8.53033C8.38968 8.67098 8.19891 8.75 8 8.75C7.80109 8.75 7.61032 8.67098 7.46967 8.53033C7.32902 8.38968 7.25 8.19891 7.25 8V4.5C7.25 4.16848 7.3817 3.85054 7.61612 3.61612C7.85054 3.3817 8.16848 3.25 8.5 3.25H15.5C15.8315 3.25 16.1495 3.3817 16.3839 3.61612C16.6183 3.85054 16.75 4.16848 16.75 4.5V8C16.7474 8.19811 16.6676 8.38737 16.5275 8.52747C16.3874 8.66756 16.1981 8.74741 16 8.75ZM15.5 20.75H8.5C8.16848 20.75 7.85054 20.6183 7.61612 20.3839C7.3817 20.1495 7.25 19.8315 7.25 19.5V12.5C7.25 12.1685 7.3817 11.8505 7.61612 11.6161C7.85054 11.3817 8.16848 11.25 8.5 11.25H15.5C15.8315 11.25 16.1495 11.3817 16.3839 11.6161C16.6183 11.8505 16.75 12.1685 16.75 12.5V19.5C16.75 19.8315 16.6183 20.1495 16.3839 20.3839C16.1495 20.6183 15.8315 20.75 15.5 20.75ZM8.75 19.25H15.25V12.75H8.75V19.25Z" />  
                        </svg>
                    </button>                    
                    <button class="bg-green-400 text-white text-xs p-2 rounded-md">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" class="text-lg" viewBox="0 0 24 24">
                            <path d="M17 19.22H5V7H12V5H5C3.9 5 3 5.9 3 7V19C3 20.1 3.9 21 5 21H17C18.1 21 19 20.1 19 19V12H17V19.22Z" />
                            <path d="M19 2H17V5H14C14.01 5.01 14 7 14 7H17V9.99C17.01 10 19 9.99 19 9.99V7H22V5H19V2ZM7 9H15V11H7V9ZM7 12V14H15V12H12H7ZM7 15H15V17H7V15Z" />
                        </svg>
                    </button>
                   
                </td>
            </tr>
        </tbody>
    </table>
</div>

<form method="post" action="{% url 'view_excel_content' %}">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit" value="View Excel Content">
  </form>
  
{% endblock content %}
